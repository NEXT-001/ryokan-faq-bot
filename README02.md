# マルチ企業FAQボット セットアップガイド

## 概要

マルチ企業FAQボットは、複数の企業が独自のFAQデータを管理し、顧客がウェブインターフェースから質問できるシステムです。各企業は独自の管理者アカウントを持ち、FAQ管理や利用履歴の確認が可能です。

### 主な特徴

- 複数企業対応: 各企業が独自のFAQデータを管理
- エンベディングベース回答検索: 意味類似度によるインテリジェントな回答
- 会社別管理者: 企業ごとの管理者アカウントによるセキュアな管理
- 簡単なデータ管理: CSVインポート/エクスポート対応

## システム要件

- Python 3.8以上
- 以下のPythonパッケージ:
  - streamlit
  - pandas
  - numpy
  - scikit-learn
  - python-dotenv
  - anthropic (オプション)
  - voyageai (オプション、エンベディング生成用)

## インストール手順

1. リポジトリをクローンまたはダウンロードする
2. 必要なパッケージをインストールする:
   ```
   pip install -r requirements.txt
   ```
3. フォルダ構造の初期化:
   ```
   mkdir -p data/companies/demo-company
   ```

## 設定方法

### 基本設定

`.env` ファイルを作成し、以下の設定を行います:

```
TEST_MODE=true
VOYAGE_API_KEY=your_api_key_here  # オプション
ANTHROPIC_API_KEY=your_api_key_here  # オプション
```

- `TEST_MODE`: `true` に設定すると、実際のAPIを使わずにテストデータで動作します
- `VOYAGE_API_KEY`: VoyageAI APIのキー (エンベディング生成用、オプション)
- `ANTHROPIC_API_KEY`: Anthropic APIのキー (拡張機能用、オプション)

### テストモードについて

テストモードでは、エンベディングAPIを呼び出さずに擬似的なエンベディングを生成します。実運用環境ではVoyageAI APIキーの設定を推奨しますが、小規模な利用ではテストモードでも十分機能します。

## 実行方法

以下のコマンドでアプリケーションを起動します:

```
streamlit run main.py
```

ブラウザが自動的に開き、アプリケーションにアクセスできます。通常は `http://localhost:8501` でアクセス可能です。

## 初期アカウント

システムは初回起動時に以下のアカウントを自動生成します:

- **スーパー管理者**:
  - 企業ID: `admin`
  - ユーザー名: `admin`
  - パスワード: `admin`
  - 注: テストモードでのみ有効

- **デモ企業管理者**:
  - 企業ID: `demo-company`
  - ユーザー名: `admin`
  - パスワード: `admin123`

## 使用方法

### 顧客向けインターフェース

1. トップページで企業を選択
2. 質問を入力し、回答を受け取る
3. 会話履歴は一時的に保存され、セッション間で保持されない

### 管理者インターフェース

1. ログインページで企業ID、ユーザー名、パスワードを入力
2. FAQ管理: 質問と回答の追加、編集、削除
3. FAQ一括管理: CSVによるインポート/エクスポート
4. 履歴確認: 顧客の質問と回答の履歴を確認
5. 管理者設定: 企業管理者アカウントの追加/削除

### スーパー管理者インターフェース

1. 企業管理: 新規企業と管理者の登録
2. FAQデモ: 各企業のFAQをテスト

## フォルダ構造

```
multi-company-faq-bot/
├── config/
│   └── settings.py         # 設定ファイル
├── data/
│   ├── companies/          # 会社別データフォルダ
│   │   ├── company1/       # 会社1のデータ
│   │   │   ├── faq.csv     # FAQデータ
│   │   │   ├── faq_with_embeddings.pkl  # エンベディング済みデータ
│   │   │   └── history.csv # 利用履歴
│   │   └── ...
│   └── companies.json      # 会社リスト
├── services/
│   ├── chat_service.py     # チャット回答サービス
│   ├── company_service.py  # 会社管理サービス
│   ├── embedding_service.py # エンベディング生成
│   ├── history_service.py  # 履歴管理
│   └── login_service.py    # ログイン認証
├── admin_faq_management.py # FAQ管理ページ
├── main.py                 # メインアプリケーション
└── requirements.txt        # 依存関係
```

## トラブルシューティング

### APIキーの問題

- VoyageAI APIキーが設定されていない場合、システムは自動的にテストモードに切り替わります
- テストモードでは簡易的なエンベディングを使用するため、精度が低下します

### データファイルの問題

- データフォルダが存在しない場合は自動的に作成されます
- 企業データが見つからない場合はデフォルトデータが生成されます

### その他の問題

- システムのログを確認して問題を特定してください
- テストモードで問題が解決するか確認してください